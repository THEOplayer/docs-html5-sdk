!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var r={registerPlayer:function(e){var t,n,r=null,a=null,o=!1,u=!1,l=!1,i=null,s=null,c=null;function d(){i({state:"unavailable",info:"The configured stream is currently unavailable."}),o=!0,function(){var e=p().querySelector(".stream-status");if(!e){(e=document.createElement("div")).className="stream-status";var t=h();if(t&&(e.style.background='url("'+t+'")',e.style.backgroundSize="cover"),r){var o=r.countdown_timestamp;if(o&&(o=new Date(1e3*parseInt(o))).getTime()>Date.now()){var u=document.createElement("div");u.className="stream-status-overlay";var l=o.toDateString(),i=o.toISOString().substr(11,5),s=r.title+"<br />"||!1;u.innerHTML=s+"Stream will start on:<br />"+l+" @ "+i,e.appendChild(u);var c=document.createElement("div");c.className="countdown",c.innerHTML="&nbsp;",u.appendChild(c),function(e){e=e.getTime();n=setInterval((function(){var t=(new Date).getTime(),r=e-t,a=Math.floor(r/864e5),o=Math.floor(r%864e5/36e5),u=Math.floor(r%36e5/6e4),l=Math.floor(r%6e4/1e3);p().querySelector(".countdown").innerHTML=a+"d "+o+"h "+u+"m "+l+"s ",r<0&&(clearInterval(n),p().querySelector(".countdown").innerHTML="Starting...")}),1e3)}(o)}}else e.textContent=a&&a.offlineText||"The stream is currently not available.",e.classList.add("no-data");p().appendChild(e)}}(),l||(l=!0,t=setInterval(w,f()))}function f(){return a&&a.retry||3e3}function v(){var e=p().querySelector(".stream-status");e&&e.parentNode.removeChild(e)}function m(){i({state:"available",info:"The configured stream is available."}),o=!1,v()}function p(){return e.element.parentNode.parentNode}function w(){var t=[e.source];if(a.backupStreams&&a.backupStreams.length>0)for(var n=0;n<a.backupStreams.length;n++)t.push(a.backupStreams[n]);console.log("sources",t);!function(){for(var e=[],n=0;n<t.length;n++){var r=t[n].sources[0].src,a=r,l=Math.round(1e12*Math.random());a=r.indexOf("?")>-1?r+"&rn="+l:r+"?rn="+l,function(n){e[n]=new XMLHttpRequest,e[n].open("GET",a,!0),e[n].onreadystatechange=function(){4===e[n].readyState&&200!==e[n].status&&u&&!o?d():4===e[n].readyState&&200===e[n].status&&o&&(m(),S(t[n],n))},e[n].send()}(n)}}()}function b(){u=!0,l||(l=!0,t=setInterval(w,f()))}function g(t){if(t.url==e.src){var n=t.url.split("?");c=n.length>1?n[1]:null}else if(c){var r=t.url+"?"+c;t.redirect({url:r})}}function y(){u=!1}function h(){return r&&r.image||e.source.metadata&&e.source.metadata.wowza&&e.source.metadata.wowza.placeholderImageUrl}function S(t,n){if(e.autoplay=!0,t){if(t.metadata.wowza.backupStreams)t=t;else{var r=e.source.metadata.wowza.backupStreams,a=function(e){e.metadata.wowza.backupStreams&&delete e.metadata.wowza.backupStreams;return e}(e.source);r[n-1]=a,t.metadata.wowza.backupStreams=r}e.source=t}else e.source=e.source}return e.addEventListener("sourcechange",(function(c){if(e&&(r=null,a=null,o=!1,clearInterval(t),clearInterval(n),u=!1,l=!1,i=null,s=null,e.network.removeEventListener("offline",d),e.removeEventListener("error",d),e.network.removeEventListener("online",m),e.removeEventListener("waiting",b),e.removeEventListener("playing",y),e.network.addRequestInterceptor(g)),v(),a=c.source.metadata&&c.source.metadata.wowza){e&&(e.network.addEventListener("offline",d),e.addEventListener("error",d),e.network.addEventListener("online",m),e.addEventListener("waiting",b),e.addEventListener("playing",y),a&&a.queryParametersPassthrough&&e.network.addRequestInterceptor(g));var f=a.jsonUrl;f&&(p=f,(w=new XMLHttpRequest).onreadystatechange=function(){4==this.readyState&&200==this.status&&(r=JSON.parse(w.responseText),s({data:r,status:"available"}),e.poster=h())},w.open("GET",p,!0),w.send()),i=a.statechangeCallback,s=a.datachangeCallback}var p,w})),{getStreamData:function(){return r},getState:function(){return o?"offline":"online"}}}};window.theoplayerWowza=r}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidGhlb3BsYXllcldvd3phIiwicmVnaXN0ZXJQbGF5ZXIiLCJwbGF5ZXIiLCJ3b3d6YVN0cmVhbUludGVydmFsIiwiY291bnRkb3duVGltZXJJbnRlcnZhbCIsIndvd3phRGF0YSIsIndvd3phU291cmNlIiwic3RyZWFtSXNVbmF2YWlsYWJsZSIsImlzV2FpdGluZyIsImhhc0ludGVydmFsIiwic3RhdGVjaGFuZ2VDYWxsYmFjayIsImRhdGFjaGFuZ2VDYWxsYmFjayIsInF1ZXJ5UGFyYW1ldGVyIiwiaGFuZGxlV293emFPZmZsaW5lIiwic3RhdGUiLCJpbmZvIiwic3RyZWFtU3RhdHVzRGl2IiwiZ2V0Q29udGFpbmVyIiwicXVlcnlTZWxlY3RvciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInBvc3RlciIsImdldFBvc3RlciIsInN0eWxlIiwiYmFja2dyb3VuZCIsImJhY2tncm91bmRTaXplIiwiY291bnRkb3duIiwiRGF0ZSIsInBhcnNlSW50IiwiZ2V0VGltZSIsIm5vdyIsImNvdW50ZG93bkRpdiIsImRhdGUiLCJ0b0RhdGVTdHJpbmciLCJoaG1tIiwidG9JU09TdHJpbmciLCJzdWJzdHIiLCJ0aXRsZSIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwiY291bnRkb3duVGltZXIiLCJjb3VudERvd25EYXRlIiwic2V0SW50ZXJ2YWwiLCJkaXN0YW5jZSIsImRheXMiLCJNYXRoIiwiZmxvb3IiLCJob3VycyIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwiY2xlYXJJbnRlcnZhbCIsInNldHVwQ291bnRkb3duIiwidGV4dENvbnRlbnQiLCJvZmZsaW5lVGV4dCIsImNsYXNzTGlzdCIsImFkZCIsImNyZWF0ZVN0cmVhbVN0YXR1c0RpdiIsInN0cmVhbUludGVydmFsIiwiZ2V0UmV0cnlUaW1lb3V0IiwicmV0cnkiLCJyZW1vdmVTdHJlYW1TdGF0dXNEaXYiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJoYW5kbGVXb3d6YU9ubGluZSIsImVsZW1lbnQiLCJzb3VyY2VzIiwic291cmNlIiwiYmFja3VwU3RyZWFtcyIsImxlbmd0aCIsInB1c2giLCJjb25zb2xlIiwibG9nIiwieGh0dHAiLCJjdXJyZW50U3JjIiwic3JjIiwidGVzdFNyYyIsInJuIiwicm91bmQiLCJyYW5kb20iLCJpbmRleE9mIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlbG9hZEN1cnJlbnRTdHJlYW0iLCJzZW5kIiwiY2hlY2tTdHJlYW1TdGF0dXMiLCJyZXF1ZXN0SW50ZXJjZXB0b3IiLCJyZXF1ZXN0IiwidXJsIiwidXJsU3BsaXQiLCJzcGxpdCIsIm5ld1VybCIsInJlZGlyZWN0Iiwic2V0UGxheWluZyIsImltYWdlIiwibWV0YWRhdGEiLCJ3b3d6YSIsInBsYWNlaG9sZGVySW1hZ2VVcmwiLCJhdXRvcGxheSIsIm9yaWdpbmFsU291cmNlRml4ZWRGb3JtYXR0aW5nIiwiZml4U291cmNlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJuZXR3b3JrIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImFkZFJlcXVlc3RJbnRlcmNlcHRvciIsInF1ZXJ5UGFyYW1ldGVyc1Bhc3N0aHJvdWdoIiwid293emFKc29uIiwianNvblVybCIsInRoaXMiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJkYXRhIiwiZ2V0U3RyZWFtRGF0YSIsImdldFN0YXRlIiwid2luZG93Il0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElBQUlJLEVBQUtYLE9BQU9ZLE9BQU8sTUFHdkIsR0FGQTFCLEVB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QkosRUFBWUksb0JBQ2xDQyxFQUFxQkwsRUFBWUssbUJBSXJDLElBQTJCZ0YsRUFDckJsQixLQWtEQyxDQUNMNEMsY0FWRixXQUNFLE9BQU9oSCxHQVVQaUgsU0FQRixXQUNFLE9BQU8vRyxFQUFzQixVQUFZLGFBVS9DZ0gsT0FBT3ZILGdCQUFrQkEiLCJmaWxlIjoidGhlb3BsYXllci13b3d6YS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsInZhciB0aGVvcGxheWVyV293emEgPSB7XG4gIHJlZ2lzdGVyUGxheWVyOiBmdW5jdGlvbiByZWdpc3RlclBsYXllcihwbGF5ZXIpIHtcbiAgICB2YXIgd293emFEYXRhID0gbnVsbDtcbiAgICB2YXIgd293emFTb3VyY2UgPSBudWxsO1xuICAgIHZhciBzdHJlYW1Jc1VuYXZhaWxhYmxlID0gZmFsc2U7XG4gICAgdmFyIHdvd3phU3RyZWFtSW50ZXJ2YWw7XG4gICAgdmFyIGNvdW50ZG93blRpbWVySW50ZXJ2YWw7XG4gICAgdmFyIGlzV2FpdGluZyA9IGZhbHNlO1xuICAgIHZhciBoYXNJbnRlcnZhbCA9IGZhbHNlO1xuICAgIHZhciBzdGF0ZWNoYW5nZUNhbGxiYWNrID0gbnVsbDtcbiAgICB2YXIgZGF0YWNoYW5nZUNhbGxiYWNrID0gbnVsbDtcbiAgICB2YXIgcXVlcnlQYXJhbWV0ZXIgPSBudWxsO1xuXG4gICAgZnVuY3Rpb24gaGFuZGxlV293emFPZmZsaW5lKCkge1xuICAgICAgc3RhdGVjaGFuZ2VDYWxsYmFjayh7XG4gICAgICAgIHN0YXRlOiBcInVuYXZhaWxhYmxlXCIsXG4gICAgICAgIGluZm86IFwiVGhlIGNvbmZpZ3VyZWQgc3RyZWFtIGlzIGN1cnJlbnRseSB1bmF2YWlsYWJsZS5cIlxuICAgICAgfSk7XG4gICAgICBzdHJlYW1Jc1VuYXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAgIGNyZWF0ZVN0cmVhbVN0YXR1c0RpdigpO1xuXG4gICAgICBpZiAoIWhhc0ludGVydmFsKSB7XG4gICAgICAgIGhhc0ludGVydmFsID0gdHJ1ZTtcbiAgICAgICAgd293emFTdHJlYW1JbnRlcnZhbCA9IHNldEludGVydmFsKHN0cmVhbUludGVydmFsLCBnZXRSZXRyeVRpbWVvdXQoKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0UmV0cnlUaW1lb3V0KCkge1xuICAgICAgcmV0dXJuIHdvd3phU291cmNlICYmIHdvd3phU291cmNlLnJldHJ5IHx8IDMwMDA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0T2ZmbGluZVRleHQoKSB7XG4gICAgICByZXR1cm4gd293emFTb3VyY2UgJiYgd293emFTb3VyY2Uub2ZmbGluZVRleHQgfHwgXCJUaGUgc3RyZWFtIGlzIGN1cnJlbnRseSBub3QgYXZhaWxhYmxlLlwiO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldHVwQ291bnRkb3duKGNvdW50RG93bkRhdGUpIHtcbiAgICAgIHZhciBjb3VudERvd25EYXRlID0gY291bnREb3duRGF0ZS5nZXRUaW1lKCk7XG4gICAgICBjb3VudGRvd25UaW1lckludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgIHZhciBkaXN0YW5jZSA9IGNvdW50RG93bkRhdGUgLSBub3c7XG4gICAgICAgIHZhciBkYXlzID0gTWF0aC5mbG9vcihkaXN0YW5jZSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XG4gICAgICAgIHZhciBob3VycyA9IE1hdGguZmxvb3IoZGlzdGFuY2UgJSAoMTAwMCAqIDYwICogNjAgKiAyNCkgLyAoMTAwMCAqIDYwICogNjApKTtcbiAgICAgICAgdmFyIG1pbnV0ZXMgPSBNYXRoLmZsb29yKGRpc3RhbmNlICUgKDEwMDAgKiA2MCAqIDYwKSAvICgxMDAwICogNjApKTtcbiAgICAgICAgdmFyIHNlY29uZHMgPSBNYXRoLmZsb29yKGRpc3RhbmNlICUgKDEwMDAgKiA2MCkgLyAxMDAwKTtcbiAgICAgICAgZ2V0Q29udGFpbmVyKCkucXVlcnlTZWxlY3RvcignLmNvdW50ZG93bicpLmlubmVySFRNTCA9IGRheXMgKyBcImQgXCIgKyBob3VycyArIFwiaCBcIiArIG1pbnV0ZXMgKyBcIm0gXCIgKyBzZWNvbmRzICsgXCJzIFwiO1xuXG4gICAgICAgIGlmIChkaXN0YW5jZSA8IDApIHtcbiAgICAgICAgICBjbGVhckludGVydmFsKGNvdW50ZG93blRpbWVySW50ZXJ2YWwpO1xuICAgICAgICAgIGdldENvbnRhaW5lcigpLnF1ZXJ5U2VsZWN0b3IoJy5jb3VudGRvd24nKS5pbm5lckhUTUwgPSBcIlN0YXJ0aW5nLi4uXCI7XG4gICAgICAgIH1cbiAgICAgIH0sIDEwMDApO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVN0cmVhbVN0YXR1c0RpdigpIHtcbiAgICAgIHZhciBzdHJlYW1TdGF0dXNEaXYgPSBnZXRDb250YWluZXIoKS5xdWVyeVNlbGVjdG9yKCcuc3RyZWFtLXN0YXR1cycpO1xuXG4gICAgICBpZiAoIXN0cmVhbVN0YXR1c0Rpdikge1xuICAgICAgICBzdHJlYW1TdGF0dXNEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgc3RyZWFtU3RhdHVzRGl2LmNsYXNzTmFtZSA9ICdzdHJlYW0tc3RhdHVzJztcbiAgICAgICAgdmFyIHBvc3RlciA9IGdldFBvc3RlcigpO1xuXG4gICAgICAgIGlmIChwb3N0ZXIpIHtcbiAgICAgICAgICBzdHJlYW1TdGF0dXNEaXYuc3R5bGUuYmFja2dyb3VuZCA9ICd1cmwoXCInICsgcG9zdGVyICsgJ1wiKSc7XG4gICAgICAgICAgc3RyZWFtU3RhdHVzRGl2LnN0eWxlLmJhY2tncm91bmRTaXplID0gJ2NvdmVyJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3b3d6YURhdGEpIHtcbiAgICAgICAgICB2YXIgY291bnRkb3duID0gd293emFEYXRhWydjb3VudGRvd25fdGltZXN0YW1wJ107XG5cbiAgICAgICAgICBpZiAoY291bnRkb3duKSB7XG4gICAgICAgICAgICBjb3VudGRvd24gPSBuZXcgRGF0ZShwYXJzZUludChjb3VudGRvd24pICogMTAwMCk7XG5cbiAgICAgICAgICAgIGlmIChjb3VudGRvd24uZ2V0VGltZSgpID4gRGF0ZS5ub3coKSkge1xuICAgICAgICAgICAgICAvLyBpbiB0aGUgZnV0dXJlXG4gICAgICAgICAgICAgIHZhciBjb3VudGRvd25EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgY291bnRkb3duRGl2LmNsYXNzTmFtZSA9IFwic3RyZWFtLXN0YXR1cy1vdmVybGF5XCI7XG4gICAgICAgICAgICAgIHZhciBkYXRlID0gY291bnRkb3duLnRvRGF0ZVN0cmluZygpO1xuICAgICAgICAgICAgICB2YXIgaGhtbSA9IGNvdW50ZG93bi50b0lTT1N0cmluZygpLnN1YnN0cigxMSwgNSk7XG4gICAgICAgICAgICAgIHZhciB0aXRsZSA9IHdvd3phRGF0YVsndGl0bGUnXSArIFwiPGJyIC8+XCIgfHwgZmFsc2U7XG4gICAgICAgICAgICAgIGNvdW50ZG93bkRpdi5pbm5lckhUTUwgPSB0aXRsZSArIFwiU3RyZWFtIHdpbGwgc3RhcnQgb246PGJyIC8+XCIgKyBkYXRlICsgXCIgQCBcIiArIGhobW07XG4gICAgICAgICAgICAgIHN0cmVhbVN0YXR1c0Rpdi5hcHBlbmRDaGlsZChjb3VudGRvd25EaXYpO1xuICAgICAgICAgICAgICB2YXIgY291bnRkb3duVGltZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgY291bnRkb3duVGltZXIuY2xhc3NOYW1lID0gJ2NvdW50ZG93bic7XG4gICAgICAgICAgICAgIGNvdW50ZG93blRpbWVyLmlubmVySFRNTCA9IFwiJm5ic3A7XCI7XG4gICAgICAgICAgICAgIGNvdW50ZG93bkRpdi5hcHBlbmRDaGlsZChjb3VudGRvd25UaW1lcik7XG4gICAgICAgICAgICAgIHNldHVwQ291bnRkb3duKGNvdW50ZG93bik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHN0cmVhbVN0YXR1c0Rpdi50ZXh0Q29udGVudCA9IGdldE9mZmxpbmVUZXh0KCk7XG4gICAgICAgICAgc3RyZWFtU3RhdHVzRGl2LmNsYXNzTGlzdC5hZGQoXCJuby1kYXRhXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2V0Q29udGFpbmVyKCkuYXBwZW5kQ2hpbGQoc3RyZWFtU3RhdHVzRGl2KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVTdHJlYW1TdGF0dXNEaXYoKSB7XG4gICAgICB2YXIgc3RyZWFtU3RhdHVzRGl2ID0gZ2V0Q29udGFpbmVyKCkucXVlcnlTZWxlY3RvcignLnN0cmVhbS1zdGF0dXMnKTtcblxuICAgICAgaWYgKHN0cmVhbVN0YXR1c0Rpdikge1xuICAgICAgICBzdHJlYW1TdGF0dXNEaXYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHJlYW1TdGF0dXNEaXYpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhhbmRsZVdvd3phT25saW5lKCkge1xuICAgICAgc3RhdGVjaGFuZ2VDYWxsYmFjayh7XG4gICAgICAgIHN0YXRlOiBcImF2YWlsYWJsZVwiLFxuICAgICAgICBpbmZvOiBcIlRoZSBjb25maWd1cmVkIHN0cmVhbSBpcyBhdmFpbGFibGUuXCJcbiAgICAgIH0pO1xuICAgICAgc3RyZWFtSXNVbmF2YWlsYWJsZSA9IGZhbHNlO1xuICAgICAgcmVtb3ZlU3RyZWFtU3RhdHVzRGl2KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Q29udGFpbmVyKCkge1xuICAgICAgcmV0dXJuIHBsYXllci5lbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTcmMoc291cmNlRGVzY3JpcHRpb24pIHtcbiAgICAgIHJldHVybiBzb3VyY2VEZXNjcmlwdGlvbi5zb3VyY2VzWzBdLnNyYztcbiAgICB9IC8vIHBhc3MgYWxvbmcgYmFjay11cHMgc3RyZWFtcyB0byBvdGhlciBzb3VyY2VkZXNjcmlwdGlvbnNcbiAgICAvLyBmdW5jdGlvbiBnZXRCYWNrdXBTdHJlYW1zKHNvdXJjZURlc2NyaXB0aW9uKSB7XG4gICAgLy8gICAgIHJldHVybiBzb3VyY2VEZXNjcmlwdGlvbi5tZXRhZGF0YS53b3d6YSAmJiBzb3VyY2VEZXNjcmlwdGlvbi5tZXRhZGF0YS53b3d6YS5iYWNrdXBTdHJlYW1zO1xuICAgIC8vIH1cblxuXG4gICAgZnVuY3Rpb24gc3RyZWFtSW50ZXJ2YWwoKSB7XG4gICAgICB2YXIgc291cmNlcyA9IFtwbGF5ZXIuc291cmNlXTtcblxuICAgICAgaWYgKHdvd3phU291cmNlLmJhY2t1cFN0cmVhbXMgJiYgd293emFTb3VyY2UuYmFja3VwU3RyZWFtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd293emFTb3VyY2UuYmFja3VwU3RyZWFtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHNvdXJjZXMucHVzaCh3b3d6YVNvdXJjZS5iYWNrdXBTdHJlYW1zW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZyhcInNvdXJjZXNcIiwgc291cmNlcyk7XG5cbiAgICAgIHZhciBmID0gKGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciB4aHR0cCA9IFtdLCBpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNvdXJjZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgY3VycmVudFNyYyA9IGdldFNyYyhzb3VyY2VzW2ldKTtcbiAgICAgICAgICB2YXIgdGVzdFNyYyA9IGN1cnJlbnRTcmM7XG4gICAgICAgICAgdmFyIHJuID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMTAwMDAwMDAwMDAwMCk7XG5cbiAgICAgICAgICBpZiAoY3VycmVudFNyYy5pbmRleE9mKFwiP1wiKSA+IC0xKSB7XG4gICAgICAgICAgICB0ZXN0U3JjID0gY3VycmVudFNyYyArIFwiJnJuPVwiICsgcm47XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRlc3RTcmMgPSBjdXJyZW50U3JjICsgXCI/cm49XCIgKyBybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAoZnVuY3Rpb24oaSl7XG4gICAgICAgICAgICB4aHR0cFtpXSA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgeGh0dHBbaV0ub3BlbihcIkdFVFwiLCB0ZXN0U3JjLCB0cnVlKTtcbiAgICAgICAgICAgIHhodHRwW2ldLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIGlmICh4aHR0cFtpXS5yZWFkeVN0YXRlID09PSA0ICYmIHhodHRwW2ldLnN0YXR1cyAhPT0gMjAwICYmIGlzV2FpdGluZyAmJiAhc3RyZWFtSXNVbmF2YWlsYWJsZSkge1xuICAgICAgICAgICAgICAgIGhhbmRsZVdvd3phT2ZmbGluZSgpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHhodHRwW2ldLnJlYWR5U3RhdGUgPT09IDQgJiYgeGh0dHBbaV0uc3RhdHVzID09PSAyMDAgJiYgc3RyZWFtSXNVbmF2YWlsYWJsZSkge1xuICAgICAgICAgICAgICAgIGhhbmRsZVdvd3phT25saW5lKCk7XG4gICAgICAgICAgICAgICAgcmVsb2FkQ3VycmVudFN0cmVhbShzb3VyY2VzW2ldLCBpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHhodHRwW2ldLnNlbmQoKTtcbiAgICAgICAgICB9KShpKTtcbiAgICAgICAgfVxuICAgICAgfSkoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGVja1N0cmVhbVN0YXR1cygpIHtcbiAgICAgIGlzV2FpdGluZyA9IHRydWU7XG5cbiAgICAgIGlmICghaGFzSW50ZXJ2YWwpIHtcbiAgICAgICAgaGFzSW50ZXJ2YWwgPSB0cnVlO1xuICAgICAgICB3b3d6YVN0cmVhbUludGVydmFsID0gc2V0SW50ZXJ2YWwoc3RyZWFtSW50ZXJ2YWwsIGdldFJldHJ5VGltZW91dCgpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXF1ZXN0SW50ZXJjZXB0b3IocmVxdWVzdCkge1xuICAgICAgaWYgKHJlcXVlc3QudXJsID09IHBsYXllci5zcmMpIHtcbiAgICAgICAgLy8gY2hlY2sgbWFzdGVyIHBsYXlsaXN0XG4gICAgICAgIHZhciB1cmxTcGxpdCA9IHJlcXVlc3QudXJsLnNwbGl0KFwiP1wiKTtcblxuICAgICAgICBpZiAodXJsU3BsaXQubGVuZ3RoID4gMSkge1xuICAgICAgICAgIC8vIGNoZWNrIGlmIG1hc3RlciBwbGF5bGlzdCBoYXMgcXVlcnkgcGFyYW1zXG4gICAgICAgICAgcXVlcnlQYXJhbWV0ZXIgPSB1cmxTcGxpdFsxXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBxdWVyeVBhcmFtZXRlciA9IG51bGw7IC8vIHJlc2V0IGlmIG5vIHF1ZXJ5IHBhcmFtc1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHF1ZXJ5UGFyYW1ldGVyKSB7XG4gICAgICAgIC8vIGlmIG5vIG1hc3RlciBwbGF5bGlzdCBhbmQgYWN0aXZlIHNldCBvZiBxdWVyeSBwYXJhbXNcbiAgICAgICAgdmFyIG5ld1VybCA9IHJlcXVlc3QudXJsICsgXCI/XCIgKyBxdWVyeVBhcmFtZXRlcjsgLy8gYXBwZW5kIHF1ZXJ5IHBhcmFtc1xuXG4gICAgICAgIHJlcXVlc3QucmVkaXJlY3Qoe1xuICAgICAgICAgIHVybDogbmV3VXJsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFBsYXlpbmcoKSB7XG4gICAgICBpc1dhaXRpbmcgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWdpc3Rlcldvd3phRXZlbnRzKCkge1xuICAgICAgaWYgKHBsYXllcikge1xuICAgICAgICBwbGF5ZXIubmV0d29yay5hZGRFdmVudExpc3RlbmVyKCdvZmZsaW5lJywgaGFuZGxlV293emFPZmZsaW5lKTtcbiAgICAgICAgcGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgaGFuZGxlV293emFPZmZsaW5lKTtcbiAgICAgICAgcGxheWVyLm5ldHdvcmsuYWRkRXZlbnRMaXN0ZW5lcignb25saW5lJywgaGFuZGxlV293emFPbmxpbmUpO1xuICAgICAgICBwbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcignd2FpdGluZycsIGNoZWNrU3RyZWFtU3RhdHVzKTtcbiAgICAgICAgcGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ3BsYXlpbmcnLCBzZXRQbGF5aW5nKTtcblxuICAgICAgICBpZiAod293emFTb3VyY2UgJiYgd293emFTb3VyY2UucXVlcnlQYXJhbWV0ZXJzUGFzc3Rocm91Z2gpIHtcbiAgICAgICAgICBwbGF5ZXIubmV0d29yay5hZGRSZXF1ZXN0SW50ZXJjZXB0b3IocmVxdWVzdEludGVyY2VwdG9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVucmVnaXN0ZXJXb3d6YUV2ZW50cygpIHtcbiAgICAgIGlmIChwbGF5ZXIpIHtcbiAgICAgICAgd293emFEYXRhID0gbnVsbDtcbiAgICAgICAgd293emFTb3VyY2UgPSBudWxsO1xuICAgICAgICBzdHJlYW1Jc1VuYXZhaWxhYmxlID0gZmFsc2U7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwod293emFTdHJlYW1JbnRlcnZhbCk7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoY291bnRkb3duVGltZXJJbnRlcnZhbCk7XG4gICAgICAgIGlzV2FpdGluZyA9IGZhbHNlO1xuICAgICAgICBoYXNJbnRlcnZhbCA9IGZhbHNlO1xuICAgICAgICBzdGF0ZWNoYW5nZUNhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgZGF0YWNoYW5nZUNhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgcGxheWVyLm5ldHdvcmsucmVtb3ZlRXZlbnRMaXN0ZW5lcignb2ZmbGluZScsIGhhbmRsZVdvd3phT2ZmbGluZSk7XG4gICAgICAgIHBsYXllci5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIGhhbmRsZVdvd3phT2ZmbGluZSk7XG4gICAgICAgIHBsYXllci5uZXR3b3JrLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29ubGluZScsIGhhbmRsZVdvd3phT25saW5lKTtcbiAgICAgICAgcGxheWVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3dhaXRpbmcnLCBjaGVja1N0cmVhbVN0YXR1cyk7XG4gICAgICAgIHBsYXllci5yZW1vdmVFdmVudExpc3RlbmVyKCdwbGF5aW5nJywgc2V0UGxheWluZyk7XG4gICAgICAgIHBsYXllci5uZXR3b3JrLmFkZFJlcXVlc3RJbnRlcmNlcHRvcihyZXF1ZXN0SW50ZXJjZXB0b3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFBvc3RlcigpIHtcbiAgICAgIHJldHVybiB3b3d6YURhdGEgJiYgd293emFEYXRhLmltYWdlIHx8IHBsYXllci5zb3VyY2UubWV0YWRhdGEgJiYgcGxheWVyLnNvdXJjZS5tZXRhZGF0YS53b3d6YSAmJiBwbGF5ZXIuc291cmNlLm1ldGFkYXRhLndvd3phLnBsYWNlaG9sZGVySW1hZ2VVcmw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc291cmNlSGFuZGxlcihlKSB7XG4gICAgICB1bnJlZ2lzdGVyV293emFFdmVudHMoKTtcbiAgICAgIHJlbW92ZVN0cmVhbVN0YXR1c0RpdigpO1xuICAgICAgd293emFTb3VyY2UgPSBlLnNvdXJjZS5tZXRhZGF0YSAmJiBlLnNvdXJjZS5tZXRhZGF0YS53b3d6YTtcblxuICAgICAgaWYgKHdvd3phU291cmNlKSB7XG4gICAgICAgIHJlZ2lzdGVyV293emFFdmVudHMoKTtcbiAgICAgICAgdmFyIHdvd3phSnNvbiA9IHdvd3phU291cmNlLmpzb25Vcmw7XG5cbiAgICAgICAgaWYgKHdvd3phSnNvbikge1xuICAgICAgICAgIHJlZ2lzdGVyV293emFEYXRhKHdvd3phSnNvbik7XG4gICAgICAgIH1cblxuICAgICAgICBzdGF0ZWNoYW5nZUNhbGxiYWNrID0gd293emFTb3VyY2Uuc3RhdGVjaGFuZ2VDYWxsYmFjaztcbiAgICAgICAgZGF0YWNoYW5nZUNhbGxiYWNrID0gd293emFTb3VyY2UuZGF0YWNoYW5nZUNhbGxiYWNrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZ2lzdGVyV293emFEYXRhKHVybCkge1xuICAgICAgdmFyIHhodHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICAgIHhodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PSA0ICYmIHRoaXMuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgIHdvd3phRGF0YSA9IEpTT04ucGFyc2UoeGh0dHAucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICBkYXRhY2hhbmdlQ2FsbGJhY2soe1xuICAgICAgICAgICAgZGF0YTogd293emFEYXRhLFxuICAgICAgICAgICAgc3RhdHVzOiBcImF2YWlsYWJsZVwiXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcGxheWVyLnBvc3RlciA9IGdldFBvc3RlcigpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB4aHR0cC5vcGVuKFwiR0VUXCIsIHVybCwgdHJ1ZSk7XG4gICAgICB4aHR0cC5zZW5kKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVsb2FkQ3VycmVudFN0cmVhbShzb3VyY2UsIGkpIHtcbiAgICAgIHBsYXllci5hdXRvcGxheSA9IHRydWU7XG4gICAgICBpZiAoc291cmNlKSB7XG4gICAgICAgIGlmIChzb3VyY2UubWV0YWRhdGEud293emEuYmFja3VwU3RyZWFtcykge1xuICAgICAgICAgICBzb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIGJhY2t1cFN0cmVhbXMgPSBwbGF5ZXIuc291cmNlLm1ldGFkYXRhLndvd3phLmJhY2t1cFN0cmVhbXM7XG4gICAgICAgICAgdmFyIG9yaWdpbmFsU291cmNlRml4ZWRGb3JtYXR0aW5nID0gZml4U291cmNlKHBsYXllci5zb3VyY2UpO1xuICAgICAgICAgIGJhY2t1cFN0cmVhbXNbaS0xXSA9IG9yaWdpbmFsU291cmNlRml4ZWRGb3JtYXR0aW5nO1xuICAgICAgICAgIHNvdXJjZS5tZXRhZGF0YS53b3d6YS5iYWNrdXBTdHJlYW1zID0gYmFja3VwU3RyZWFtcztcbiAgICAgICAgfVxuICAgICAgICBwbGF5ZXIuc291cmNlID0gc291cmNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGxheWVyLnNvdXJjZSA9IHBsYXllci5zb3VyY2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZml4U291cmNlKHNvdXJjZSkge1xuICAgICAgaWYgKHNvdXJjZS5tZXRhZGF0YS53b3d6YS5iYWNrdXBTdHJlYW1zKSB7XG4gICAgICAgIGRlbGV0ZSBzb3VyY2UubWV0YWRhdGEud293emEuYmFja3VwU3RyZWFtcztcbiAgICAgIH1cbiAgICAgIHJldHVybiBzb3VyY2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0V293emFEYXRhKCkge1xuICAgICAgcmV0dXJuIHdvd3phRGF0YTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZSgpIHtcbiAgICAgIHJldHVybiBzdHJlYW1Jc1VuYXZhaWxhYmxlID8gXCJvZmZsaW5lXCIgOiBcIm9ubGluZVwiO1xuICAgIH1cblxuICAgIHBsYXllci5hZGRFdmVudExpc3RlbmVyKCdzb3VyY2VjaGFuZ2UnLCBzb3VyY2VIYW5kbGVyKTtcbiAgICByZXR1cm4ge1xuICAgICAgZ2V0U3RyZWFtRGF0YTogZ2V0V293emFEYXRhLFxuICAgICAgZ2V0U3RhdGU6IGdldFN0YXRlXG4gICAgfTtcbiAgfVxufTtcbndpbmRvdy50aGVvcGxheWVyV293emEgPSB0aGVvcGxheWVyV293emE7Il0sInNvdXJjZVJvb3QiOiIifQ==